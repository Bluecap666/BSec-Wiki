# 企业系统漏洞


### 一、 客户关系管理系统（CRM）

常见的CRM系统包括 Salesforce、用友CRM、金蝶CRM、SugarCRM、SuiteCRM等。

1. **专用检测工具**
   * **CRM-EXP-Tools（各类开源工具）** ：在GitHub、GitLab等平台存在大量针对特定CRM系统的漏洞检测工具。
   * **示例** ：针对 **SugarCRM** 和  **SuiteCRM** （开源版本）的工具有很多，涵盖了其历史漏洞（如CVE-2021-35247等）。
   * **Metasploit Framework** ：这个强大的渗透测试框架包含了多个CRM系统的漏洞利用模块。
   * 例如，可以搜索 `search type:exploit sugarcrm` 来查找针对SugarCRM的漏洞利用模块。
2. **检测方法**
   * **信息收集** ：确定CRM的具体类型和版本。访问 `/install.php`、`/readme.html` 等文件，或通过页面元标签识别。
   * **漏洞搜索** ：在  **CVE** 、 **NVD** 、**ExploitDB** 等漏洞库中搜索该版本CRM的已知漏洞。
   * **工具检测** ：使用上述专用工具或Metasploit进行验证。

### 二、 企业资源计划系统（ERP）

常见的ERP系统包括 SAP、Oracle E-Business Suite、用友、金蝶等。这类系统极其复杂，漏洞影响也往往非常严重。

1. **专用检测工具与研究项目**
   * **ERPSCAN** ：这是一家专注于ERP系统（尤其是SAP和Oracle）安全的知名公司。他们发布了很多研究文章和 **专用扫描器** 。
   * **Metasploit Modules** ：Metasploit包含大量针对SAP和Oracle ERP的漏洞利用模块，从认证绕过到远程代码执行应有尽有。
   * **Onapsis** ：另一家专注于业务关键型应用（如SAP）安全的公司，其产品属于企业级解决方案。
   * **GitHub上的各类ERP-EXP** ：针对用友、金蝶等国内ERP的漏洞检测工具在GitHub上也很活跃。
2. **检测方法**
   * **端口与服务发现** ：SAP系统有大量特定端口（如32xx, 33xx, 80xx等），Oracle EBS也有特定端口。使用 **Nmap** 扫描可以发现它们。
   * **专项扫描** ：由于ERP系统复杂，最好使用像 **Nessus** 这样的综合扫描器（它包含专门的SAP和Oracle策略）或上述专用工具进行深度扫描。
   * **手动测试** ：重点关注权限管理、业务流程逻辑漏洞。

### 三、 内容管理系统（CMS）

最常见的CMS包括 WordPress、Joomla!、Drupal、国内的帝国CMS、织梦DedeCMS等。这些系统拥有庞大的插件/主题生态，是漏洞的重灾区。

1. **专用检测工具**

   * **WPScan** ：WordPress安全扫描的 **行业标准** 。它可以枚举用户名、主题、插件，并基于庞大的漏洞数据库检查WordPress核心、插件和主题的已知漏洞。
   * **JoomScan** ：专门用于检测Joomla! CMS漏洞的开源工具。
   * **Droopescan** ：一款用于扫描Drupal、Silverstripe、WordPress的插件扫描工具。
   * **CMSmap** ：一款开源的CMS扫描器，支持WordPress、Joomla!、Drupal。
2. **检测方法**

   * **指纹识别** ：使用  **Wappalyzer** （浏览器插件）或  **WhatWeb** （命令行工具）快速识别CMS类型和版本。
   * **专项扫描** ：根据识别结果，使用对应的专用工具（如WPScan）进行深度扫描。
   * **插件/主题审计** ：手动检查已安装的插件和主题，查找已知漏洞和弱配置。

### 四、 办公自动化系统（OA）

如泛微、致远、蓝凌等，用户基数大、业务关键性强，且经常暴露在互联网上这类工具专门为检测主流OA系统的历史漏洞而开发，通常是安全研究人员在GitHub等平台开源的项目。它们针对性强，利用代码（PoC/Exp）成熟，检测准确率高。

1. **OA-EXP-Framework**
   * **简介** ：这可能是目前最全面、最知名的OA漏洞利用框架。
   * **特点** ：
   * 集成了泛微（Weaver）、致远（Seeyon）、蓝凌（Landray）等主流OA系统的数十个高危漏洞。
   * 提供图形化界面（GUI），操作简单，一键检测和利用。
   * 持续更新，跟进最新的OA漏洞。
   * **适用场景** ：红队行动、渗透测试、企业自检。**这是检测OA系统的首选工具之一。**
2. **Weaver-EXP-Tools / 泛微漏洞利用工具**
   * **简介** ：专门针对泛微e-cology OA系统的工具集。
   * **特点** ：汇集了泛微OA的历史经典漏洞，如数据库读取、文件上传、反序列化、SQL注入等。
   * **适用场景** ：当目标明确使用泛微OA时，可以进行深度检测。
3. **Seeyon-EXP-Tools / 致远漏洞利用工具**
   * **简介** ：专门针对致远互联OA系统的工具集。
   * **特点** ：包含了致远OA的多个高危漏洞利用，如经典的前台Session泄漏、SQL注入、文件上传等。
   * **适用场景** ：针对致远OA的专项检测。
4. **Lanling-EXP-Tools / 蓝凌漏洞利用工具**
   * **简介** ：针对蓝凌OA系统的检测工具。
   * **特点** ：虽然相对前两者较少，但也在不断更新，包含了蓝凌OA的已知高危漏洞。


### 五、企业级系统漏洞检测通用流程与核心工具总结

无论面对何种系统，一个系统化的方法至关重要：

1. **资产发现与识别**
   * **工具** ： **Nmap** 、 **Masscan** 、 **FOFA** 、**Shodan**
   * **目标** ：找到所有在线的主机和服务，初步判断系统类型。
2. **指纹识别与信息收集**
   * **工具** ： **Wappalyzer** 、 **WhatWeb** 、**Burp Suite** 的爬虫、浏览器开发者工具。
   * **目标** ：精确识别目标系统的 **具体名称和版本号** 。
3. **漏洞关联与扫描**
   * **步骤1：综合扫描**
     * **工具** ：**Nessus** / **OpenVAS**
     * **目的** ：进行第一轮广谱扫描，发现常见的、高威胁的漏洞。
   * **步骤2：专项扫描**
     * **工具** ：
     * **OA系统** -> `OA-EXP-Framework`
     * **WordPress** -> `WPScan`
     * **ERP** -> 相关Metasploit模块、ERPSCAN研究
     * **其他系统** -> 在GitHub、ExploitDB搜索 `[系统名] exploit` 或 `[系统名] scanner`
     * **目的** ：进行深度、精准的漏洞检测。
4. **手动验证与深度测试**
   * **工具** ： **Burp Suite** 、 **浏览器** 、**自定义脚本**
   * **目的** ：
   * 验证自动化工具的扫描结果，排除误报。
   * 发现自动化工具无法发现的 **逻辑漏洞** （如越权、业务逻辑绕过）。
   * 对找到的漏洞进行利用，评估其真实风险。
5. **漏洞管理与报告**
   * **工具** ： **JIRA** 、 **Confluence** 、或专用的漏洞管理平台。
   * **目的** ：跟踪漏洞生命周期，推动修复。

### 六、核心工具池推荐（构建你的武器库）

* **信息收集** ：Nmap, FOFA, Wappalyzer
* **综合扫描** ：Nessus (商业) / OpenVAS (开源)
* **Web专项** ：Burp Suite (商业) / OWASP ZAP (开源)
* **利用框架** ：Metasploit
* **CMS专项** ：WPScan, JoomScan, CMSmap
* **OA/ERP/CRM专项** ：密切关注GitHub上的安全社区和开源项目，这是这些系统漏洞检测工具最活跃的地方。
